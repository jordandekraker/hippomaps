<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Morphology &mdash; Hippomaps 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=264bf13b"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Histology-MRI-9p4T" href="Histology-MRI-9p4T.html" />
    <link rel="prev" title="Tutorials" href="../tutorials.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Hippomaps
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Morphology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Histology-data">Histology data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Ultra-high-field-MRI-data-at-7T">Ultra-high field MRI data at 7T</a></li>
<li class="toctree-l3"><a class="reference internal" href="#High-field-MRI-data-at-3T">High-field MRI data at 3T</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Histology-MRI-9p4T.html">Histology-MRI-9p4T</a></li>
<li class="toctree-l2"><a class="reference internal" href="MRI-7T-struct.html">MRI-7T-struct</a></li>
<li class="toctree-l2"><a class="reference internal" href="MRI-3T-rsfMRI.html">MRI-3T-rsfMRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="iEEG.html">iEEG</a></li>
<li class="toctree-l2"><a class="reference internal" href="DimReduct.html">Dimensionality-Reduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="MRI-3T-taskfMRI.html">MRI-3T-taskfMRI</a></li>
<li class="toctree-l2"><a class="reference internal" href="TLE-HC.html">Case control atrophy mapping in temporal lobe epilepsy vs healthy controls (TLE-HC)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">Tools Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">References &amp; Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Hippomaps</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Morphology</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Morphology">
<h1>Morphology<a class="headerlink" href="#Morphology" title="Permalink to this heading"></a></h1>
<p><strong>Overview</strong></p>
<p>Morphological measures of thickness, gyrification, and curvature are calculated within HippUnfold. Here we examine these to ensure they are consistent with previous work, and that they don’t differ drastically between datasets.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nib</span>
<span class="kn">import</span> <span class="nn">hippomaps</span> <span class="k">as</span> <span class="nn">hm</span>
</pre></div>
</div>
</div>
<section id="Histology-data">
<h2>Histology data<a class="headerlink" href="#Histology-data" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_dir</span> <span class="o">=</span> <span class="s1">&#39;../../publication-hippomaps/sourcedata/BIDS_HISTO/&#39;</span>
<span class="n">hippunfold_dir</span> <span class="o">=</span> <span class="s1">&#39;../../publication-hippomaps/hippunfold/HISTO_v1.3.0_100um/hippunfold/&#39;</span>

<span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bbhist&#39;</span><span class="p">,</span> <span class="s1">&#39;bbhist&#39;</span><span class="p">,</span> <span class="s1">&#39;pli3d&#39;</span><span class="p">,</span> <span class="s1">&#39;122017&#39;</span><span class="p">,</span> <span class="s1">&#39;122017&#39;</span><span class="p">,</span> <span class="s1">&#39;152017&#39;</span><span class="p">,</span> <span class="s1">&#39;152017&#39;</span><span class="p">]</span>
<span class="n">ses</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">hemis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="s1">&#39;hipp&#39;</span>
<span class="n">den</span><span class="o">=</span><span class="s1">&#39;unfoldiso&#39;</span>

<span class="c1"># get expected number of vertices and their indices</span>
<span class="n">nV</span><span class="p">,</span><span class="n">iV</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_nVertices</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">den</span><span class="p">)</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;thickness&#39;</span><span class="p">,</span> <span class="s1">&#39;gyrification&#39;</span><span class="p">,</span> <span class="s1">&#39;curvature&#39;</span><span class="p">]</span>
<span class="n">morph_dat_hist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nV</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">subs</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">d</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">sub</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subs</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hippunfold_dir</span><span class="si">}</span><span class="s1">/sub-</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1">/surf/sub-</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1">_hemi-</span><span class="si">{</span><span class="n">hemis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="si">}</span><span class="s1">_space-corobl&#39;</span>\
                     <span class="sa">f</span><span class="s1">&#39;_den-</span><span class="si">{</span><span class="n">den</span><span class="si">}</span><span class="s1">_label-</span><span class="si">{</span><span class="n">labels</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">.shape.gii&#39;</span><span class="p">)</span>
        <span class="n">morph_dat_hist</span><span class="p">[:,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">darrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="k">if</span> <span class="n">feature</span><span class="o">==</span><span class="s1">&#39;curvature&#39;</span><span class="p">:</span>
            <span class="n">morph_dat_hist</span><span class="p">[:,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">morph_dat_hist</span><span class="p">[:,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">hemis</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;R&quot;</span><span class="p">:</span>
                <span class="n">morph_dat_hist</span><span class="p">[:,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">morph_dat_hist</span><span class="p">[:,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hm</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">surfplot_canonical_foldunfold</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">morph_dat_hist</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">hemis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">unfoldAPrescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">den</span><span class="o">=</span><span class="n">den</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">share</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">tighten_cwindow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embed_nb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/export03/data/opt/venv/lib/python3.8/site-packages/brainspace/plotting/base.py:287: UserWarning: Interactive mode requires &#39;panel&#39;. Setting &#39;interactive=False&#39;
  warnings.warn(&#34;Interactive mode requires &#39;panel&#39;. &#34;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Morphology_4_1.png" src="../_images/tutorials_Morphology_4_1.png" />
</div>
</div>
</section>
<section id="Ultra-high-field-MRI-data-at-7T">
<h2>Ultra-high field MRI data at 7T<a class="headerlink" href="#Ultra-high-field-MRI-data-at-7T" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hippunfold_dir</span> <span class="o">=</span> <span class="s1">&#39;../../publication-hippomaps/hippunfold/PNI_v1.3.0_super/hippunfold&#39;</span>

<span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PNC002&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC003&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC006&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC007&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC009&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC010&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC015&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC016&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC018&#39;</span><span class="p">,</span> <span class="s1">&#39;PNC019&#39;</span><span class="p">]</span>
<span class="n">ses</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">hemis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hipp&#39;</span><span class="p">]</span><span class="c1">#,&#39;dentate&#39;]</span>
<span class="n">den</span> <span class="o">=</span> <span class="s1">&#39;0p5mm&#39;</span>

<span class="c1"># get expected number of vertices and their indices</span>
<span class="n">nV</span><span class="p">,</span><span class="n">iV</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_nVertices</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">den</span><span class="p">)</span>

<span class="n">morph_dat_MRI7T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nV</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">subs</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">d</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">hemi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hemis</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">sub</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subs</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hippunfold_dir</span><span class="si">}</span><span class="s1">/sub-</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1">/surf/sub-</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1">_hemi-</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">_space-T1w&#39;</span>\
                                 <span class="sa">f</span><span class="s1">&#39;_den-</span><span class="si">{</span><span class="n">den</span><span class="si">}</span><span class="s1">_label-</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">.shape.gii&#39;</span><span class="p">)</span>
                    <span class="n">morph_dat_MRI7T</span><span class="p">[</span><span class="n">iV</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">h</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">darrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> not found&#39;</span><span class="p">)</span>
<span class="n">morph_dat_MRI7T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">morph_dat_MRI7T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hm</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">surfplot_canonical_foldunfold</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">morph_dat_MRI7T</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">hemis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">unfoldAPrescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">den</span><span class="o">=</span><span class="n">den</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">share</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">tighten_cwindow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embed_nb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Morphology_7_0.png" src="../_images/tutorials_Morphology_7_0.png" />
</div>
</div>
</section>
<section id="High-field-MRI-data-at-3T">
<h2>High-field MRI data at 3T<a class="headerlink" href="#High-field-MRI-data-at-3T" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hippunfold_dir</span> <span class="o">=</span> <span class="s1">&#39;../../publication-hippomaps/hippunfold/MICs_v1.3.0/hippunfold&#39;</span>

<span class="n">subs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;HC048&#39;</span><span class="p">,</span> <span class="s1">&#39;HC043&#39;</span><span class="p">,</span> <span class="s1">&#39;HC087&#39;</span><span class="p">,</span> <span class="s1">&#39;HC037&#39;</span><span class="p">,</span> <span class="s1">&#39;HC055&#39;</span><span class="p">,</span> <span class="s1">&#39;HC100&#39;</span><span class="p">,</span> <span class="s1">&#39;HC036&#39;</span><span class="p">,</span> <span class="s1">&#39;HC017&#39;</span><span class="p">,</span> <span class="s1">&#39;HC088&#39;</span><span class="p">,</span> <span class="s1">&#39;HC040&#39;</span><span class="p">,</span> <span class="s1">&#39;HC058&#39;</span><span class="p">,</span> <span class="s1">&#39;HC076&#39;</span><span class="p">,</span> <span class="s1">&#39;HC090&#39;</span><span class="p">,</span> <span class="s1">&#39;HC059&#39;</span><span class="p">,</span> <span class="s1">&#39;HC101&#39;</span><span class="p">,</span> <span class="s1">&#39;HC063&#39;</span><span class="p">,</span> <span class="s1">&#39;HC094&#39;</span><span class="p">,</span> <span class="s1">&#39;HC024&#39;</span><span class="p">,</span> <span class="s1">&#39;HC050&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HC080&#39;</span><span class="p">,</span> <span class="s1">&#39;HC013&#39;</span><span class="p">,</span> <span class="s1">&#39;HC026&#39;</span><span class="p">,</span> <span class="s1">&#39;HC001&#39;</span><span class="p">,</span> <span class="s1">&#39;HC084&#39;</span><span class="p">,</span> <span class="s1">&#39;HC105&#39;</span><span class="p">,</span> <span class="s1">&#39;HC083&#39;</span><span class="p">,</span> <span class="s1">&#39;HC042&#39;</span><span class="p">,</span> <span class="s1">&#39;HC014&#39;</span><span class="p">,</span> <span class="s1">&#39;HC033&#39;</span><span class="p">,</span> <span class="s1">&#39;HC081&#39;</span><span class="p">,</span> <span class="s1">&#39;HC106&#39;</span><span class="p">,</span> <span class="s1">&#39;HC108&#39;</span><span class="p">,</span> <span class="s1">&#39;HC095&#39;</span><span class="p">,</span> <span class="s1">&#39;HC002&#39;</span><span class="p">,</span> <span class="s1">&#39;HC102&#39;</span><span class="p">,</span> <span class="s1">&#39;HC028&#39;</span><span class="p">,</span> <span class="s1">&#39;HC020&#39;</span><span class="p">,</span> <span class="s1">&#39;HC049&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HC007&#39;</span><span class="p">,</span> <span class="s1">&#39;HC023&#39;</span><span class="p">,</span> <span class="s1">&#39;HC065&#39;</span><span class="p">,</span> <span class="s1">&#39;HC025&#39;</span><span class="p">,</span> <span class="s1">&#39;HC056&#39;</span><span class="p">,</span> <span class="s1">&#39;HC003&#39;</span><span class="p">,</span> <span class="s1">&#39;HC015&#39;</span><span class="p">,</span> <span class="s1">&#39;HC077&#39;</span><span class="p">,</span> <span class="s1">&#39;HC067&#39;</span><span class="p">,</span> <span class="s1">&#39;HC072&#39;</span><span class="p">,</span> <span class="s1">&#39;HC109&#39;</span><span class="p">,</span> <span class="s1">&#39;HC086&#39;</span><span class="p">,</span> <span class="s1">&#39;HC089&#39;</span><span class="p">,</span> <span class="s1">&#39;HC091&#39;</span><span class="p">,</span> <span class="s1">&#39;HC031&#39;</span><span class="p">,</span> <span class="s1">&#39;HC039&#39;</span><span class="p">,</span> <span class="s1">&#39;HC112&#39;</span><span class="p">,</span> <span class="s1">&#39;HC068&#39;</span><span class="p">,</span> <span class="s1">&#39;HC034&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HC032&#39;</span><span class="p">,</span> <span class="s1">&#39;HC060&#39;</span><span class="p">,</span> <span class="s1">&#39;HC047&#39;</span><span class="p">,</span> <span class="s1">&#39;HC103&#39;</span><span class="p">,</span> <span class="s1">&#39;HC046&#39;</span><span class="p">,</span> <span class="s1">&#39;HC009&#39;</span><span class="p">,</span> <span class="s1">&#39;HC097&#39;</span><span class="p">,</span> <span class="s1">&#39;HC116&#39;</span><span class="p">,</span> <span class="s1">&#39;HC053&#39;</span><span class="p">,</span> <span class="s1">&#39;HC079&#39;</span><span class="p">,</span> <span class="s1">&#39;HC029&#39;</span><span class="p">,</span> <span class="s1">&#39;HC075&#39;</span><span class="p">,</span> <span class="s1">&#39;HC078&#39;</span><span class="p">,</span> <span class="s1">&#39;HC057&#39;</span><span class="p">,</span> <span class="s1">&#39;HC018&#39;</span><span class="p">,</span> <span class="s1">&#39;HC074&#39;</span><span class="p">,</span> <span class="s1">&#39;HC064&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HC096&#39;</span><span class="p">,</span> <span class="s1">&#39;HC010&#39;</span><span class="p">,</span> <span class="s1">&#39;HC038&#39;</span><span class="p">,</span> <span class="s1">&#39;HC093&#39;</span><span class="p">,</span> <span class="s1">&#39;HC082&#39;</span><span class="p">,</span> <span class="s1">&#39;HC092&#39;</span><span class="p">,</span> <span class="s1">&#39;HC027&#39;</span><span class="p">,</span> <span class="s1">&#39;HC019&#39;</span><span class="p">,</span> <span class="s1">&#39;HC005&#39;</span><span class="p">,</span> <span class="s1">&#39;HC008&#39;</span><span class="p">,</span> <span class="s1">&#39;HC011&#39;</span><span class="p">,</span> <span class="s1">&#39;HC044&#39;</span><span class="p">,</span> <span class="s1">&#39;HC030&#39;</span><span class="p">,</span> <span class="s1">&#39;HC035&#39;</span><span class="p">,</span> <span class="s1">&#39;HC085&#39;</span><span class="p">,</span> <span class="s1">&#39;HC069&#39;</span><span class="p">,</span> <span class="s1">&#39;HC041&#39;</span><span class="p">,</span> <span class="s1">&#39;HC012&#39;</span><span class="p">,</span> <span class="s1">&#39;HC054&#39;</span><span class="p">,</span> <span class="s1">&#39;HC022&#39;</span><span class="p">,</span> <span class="s1">&#39;HC016&#39;</span><span class="p">,</span> <span class="s1">&#39;HC099&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HC073&#39;</span><span class="p">,</span> <span class="s1">&#39;HC052&#39;</span><span class="p">,</span> <span class="s1">&#39;HC045&#39;</span><span class="p">]</span>
<span class="n">ses</span> <span class="o">=</span> <span class="s1">&#39;ses-01&#39;</span>
<span class="n">hemis</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hipp&#39;</span><span class="p">]</span><span class="c1">#,&#39;dentate&#39;]</span>
<span class="n">den</span> <span class="o">=</span> <span class="s1">&#39;0p5mm&#39;</span>

<span class="c1"># get expected number of vertices and their indices</span>
<span class="n">nV</span><span class="p">,</span><span class="n">iV</span> <span class="o">=</span> <span class="n">hm</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get_nVertices</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span><span class="n">den</span><span class="p">)</span>

<span class="n">morph_dat_MRI3T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nV</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">subs</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">d</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">hemi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hemis</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span><span class="n">label</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">s</span><span class="p">,</span><span class="n">sub</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">subs</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">hippunfold_dir</span><span class="si">}</span><span class="s1">/sub-</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">ses</span><span class="si">}</span><span class="s1">/surf/sub-</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">ses</span><span class="si">}</span><span class="s1">_hemi-</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">_space-T1w&#39;</span>\
                                 <span class="sa">f</span><span class="s1">&#39;_den-</span><span class="si">{</span><span class="n">den</span><span class="si">}</span><span class="s1">_label-</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">.shape.gii&#39;</span><span class="p">)</span>
                    <span class="n">morph_dat_MRI3T</span><span class="p">[</span><span class="n">iV</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">h</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">darrays</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sub</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> not found&#39;</span><span class="p">)</span>
<span class="n">morph_dat_MRI3T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">morph_dat_MRI3T</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,:,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hm</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">surfplot_canonical_foldunfold</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">morph_dat_MRI3T</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="n">hemis</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">unfoldAPrescale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">den</span><span class="o">=</span><span class="n">den</span><span class="p">,</span> <span class="n">color_bar</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">share</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">tighten_cwindow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">embed_nb</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_Morphology_10_0.png" src="../_images/tutorials_Morphology_10_0.png" />
</div>
</div>
<p><strong>save</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save 2D map</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">hemi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hemis</span><span class="p">):</span>
        <span class="n">cdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">morph_dat_MRI3T</span><span class="p">[</span><span class="n">iV</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">h</span><span class="p">,:,</span><span class="n">f</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="n">data_array</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">gifti</span><span class="o">.</span><span class="n">GiftiDataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cdat</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">gifti</span><span class="o">.</span><span class="n">GiftiImage</span><span class="p">()</span>
        <span class="n">image</span><span class="o">.</span><span class="n">add_gifti_data_array</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
        <span class="n">nib</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;../maps/HippoMaps-initializationMaps/Dataset-MICs/MRI-3T-</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">_average-99_hemi-</span><span class="si">{</span><span class="n">hemi</span><span class="si">}</span><span class="s1">_den-0p5mm_label-hipp.shape.gii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save 2D map</span>
<span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="n">cdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">morph_dat_MRI7T</span><span class="p">[</span><span class="n">iV</span><span class="p">[</span><span class="mi">0</span><span class="p">],:,:,</span><span class="n">f</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">gifti</span><span class="o">.</span><span class="n">GiftiDataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cdat</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">gifti</span><span class="o">.</span><span class="n">GiftiImage</span><span class="p">()</span>
    <span class="n">image</span><span class="o">.</span><span class="n">add_gifti_data_array</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
    <span class="n">nib</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;../maps/HippoMaps-initializationMaps/Dataset-PNI/MRI-7T-</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">_average-20_hemi-mix_den-0p5mm_label-hipp.shape.gii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span><span class="p">,</span><span class="n">feature</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features</span><span class="p">):</span>
    <span class="n">cdat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">morph_dat_hist</span><span class="p">[:,:,</span><span class="n">f</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="n">data_array</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">gifti</span><span class="o">.</span><span class="n">GiftiDataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cdat</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">nib</span><span class="o">.</span><span class="n">gifti</span><span class="o">.</span><span class="n">GiftiImage</span><span class="p">()</span>
    <span class="n">image</span><span class="o">.</span><span class="n">add_gifti_data_array</span><span class="p">(</span><span class="n">data_array</span><span class="p">)</span>
    <span class="n">nib</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;../maps/HippoMaps-initializationMaps/Dataset-Mixed/histology-</span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s1">_average-7_hemi-mix_den-unfoldiso_label-hipp.shape.gii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {}, "version_major": 2, "version_minor": 0}
</script></section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Histology-MRI-9p4T.html" class="btn btn-neutral float-right" title="Histology-MRI-9p4T" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, DeKraker.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>